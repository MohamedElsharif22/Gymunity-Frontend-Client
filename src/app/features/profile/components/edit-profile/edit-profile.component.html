<div class="w-full bg-white rounded-lg border border-gray-200 p-6">
  <!-- User Info Header -->
  <div class="mb-6 pb-6 border-b border-gray-200">
    <div class="flex items-center justify-between">
      <div>
        <h2 class="text-2xl font-bold text-gray-900">Edit Profile</h2>
        <p class="text-gray-600 text-sm mt-1">Update your fitness and personal information</p>
      </div>
      <div class="text-right">
        <p class="text-sm text-gray-600">Logged in as:</p>
        <p class="font-semibold text-gray-900">{{ userName() }}</p>
        <p class="text-xs text-gray-500">{{ userEmail() }}</p>
      </div>
    </div>
  </div>

  <!-- Error Message -->
  @if (error()) {
    <div class="bg-red-50 border-l-4 border-red-400 p-4 mb-6 rounded flex items-start gap-3">
      <span class="text-2xl shrink-0">⚠️</span>
      <span class="text-red-700 font-medium">{{ error() }}</span>
    </div>
  }

  <!-- Success Message -->
  @if (success()) {
    <div class="bg-green-50 border-l-4 border-green-400 p-4 mb-6 rounded flex items-start gap-3">
      <span class="text-2xl shrink-0">✓</span>
      <span class="text-green-700 font-medium">{{ success() }}</span>
    </div>
  }

  <!-- Form -->
  <form [formGroup]="editForm" (ngSubmit)="onSubmit()" class="space-y-6">
    <!-- User Name -->
    <div>
      <label for="userName" class="block text-sm font-medium text-gray-700 mb-2">
        Username *
      </label>
      <input
        type="text"
        id="userName"
        formControlName="userName"
        placeholder="Enter your username"
        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        [disabled]="loading() || authLoading()"
      />
      @if (editForm.get('userName')?.invalid && editForm.get('userName')?.touched) {
        <p class="text-red-600 text-sm mt-1">
          @if (editForm.get('userName')?.errors?.['required']) {
            Username is required
          } @else if (editForm.get('userName')?.errors?.['minlength']) {
            Username must be at least 3 characters
          } @else if (editForm.get('userName')?.errors?.['maxlength']) {
            Username cannot exceed 50 characters
          }
        </p>
      }
    </div>

    <!-- Two Column Layout -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Height -->
      <div>
        <label for="heightCm" class="block text-sm font-medium text-gray-700 mb-2">
          Height (cm)
        </label>
        <input
          type="number"
          id="heightCm"
          formControlName="heightCm"
          placeholder="Enter height in cm"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          [disabled]="loading() || authLoading()"
        />
        @if (editForm.get('heightCm')?.invalid && editForm.get('heightCm')?.touched) {
          <p class="text-red-600 text-sm mt-1">Height must be between 50 and 300 cm</p>
        }
      </div>

      <!-- Starting Weight -->
      <div>
        <label for="startingWeightKg" class="block text-sm font-medium text-gray-700 mb-2">
          Starting Weight (kg)
        </label>
        <input
          type="number"
          id="startingWeightKg"
          formControlName="startingWeightKg"
          placeholder="Enter weight in kg"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          [disabled]="loading() || authLoading()"
        />
        @if (editForm.get('startingWeightKg')?.invalid && editForm.get('startingWeightKg')?.touched) {
          <p class="text-red-600 text-sm mt-1">Weight must be between 20 and 500 kg</p>
        }
      </div>
    </div>

    <!-- Three Column Layout -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <!-- Gender -->
      <div>
        <label for="gender" class="block text-sm font-medium text-gray-700 mb-2">
          Gender
        </label>
        <select
          id="gender"
          formControlName="gender"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          [disabled]="loading() || authLoading()"
        >
          <option [value]="null">Select gender</option>
          @for (option of genderOptions; track option.value) {
            <option [value]="option.value">{{ option.label }}</option>
          }
        </select>
      </div>

      <!-- Goal -->
      <div>
        <label for="goal" class="block text-sm font-medium text-gray-700 mb-2">
          Fitness Goal
        </label>
        <select
          id="goal"
          formControlName="goal"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          [disabled]="loading() || authLoading()"
        >
          <option [value]="null">Select a goal</option>
          @for (option of goalOptions; track option.value) {
            <option [value]="option.value">{{ option.label }}</option>
          }
        </select>
      </div>

      <!-- Experience Level -->
      <div>
        <label for="experienceLevel" class="block text-sm font-medium text-gray-700 mb-2">
          Experience Level
        </label>
        <select
          id="experienceLevel"
          formControlName="experienceLevel"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          [disabled]="loading() || authLoading()"
        >
          <option [value]="null">Select level</option>
          @for (option of experienceLevelOptions; track option.value) {
            <option [value]="option.value">{{ option.label }}</option>
          }
        </select>
      </div>
    </div>

    <!-- Form Actions -->
    <div class="flex gap-4 pt-6 border-t border-gray-200">
      <button
        type="submit"
        [disabled]="loading() || authLoading() || editForm.invalid"
        class="flex-1 px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition duration-200 flex items-center justify-center gap-2"
      >
        @if (loading()) {
          <div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
          <span>Saving...</span>
        } @else {
          <span>✓</span>
          <span>Save Profile</span>
        }
      </button>
      <button
        type="button"
        (click)="onCancel()"
        [disabled]="loading() || authLoading()"
        class="px-6 py-3 bg-gray-200 text-gray-900 font-semibold rounded-lg hover:bg-gray-300 disabled:bg-gray-100 disabled:cursor-not-allowed transition duration-200"
      >
        Cancel
      </button>
    </div>
  </form>
</div>
