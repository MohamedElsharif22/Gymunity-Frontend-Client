<div class="container mx-auto px-4 py-8 max-w-2xl">
  <h1 class="text-3xl font-bold mb-8">Onboarding</h1>

  @if (checkingStatus()) {
    <div class="text-center py-8">
      <p class="text-gray-600">Checking onboarding status...</p>
    </div>
  } @else {
    <!-- If Onboarding is Completed -->
    @if (isCompleted()) {
      <div class="bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-300 rounded-2xl p-8 text-center">
        <div class="mb-4">
          <div class="inline-flex items-center justify-center w-16 h-16 bg-green-500 text-white rounded-full">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
          </div>
        </div>
        <h2 class="text-2xl font-bold text-green-700 mb-2">Onboarding Completed!</h2>
        <p class="text-green-600 text-lg mb-4">Congratulations! Your fitness profile is set up.</p>
        <p class="text-green-600 mb-6">You're all set to start your fitness journey. Head to the dashboard or browse programs to get started.</p>
        <a href="/dashboard" class="inline-block bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-lg font-semibold transition shadow-lg">
          Go to Dashboard
        </a>
      </div>
    } 
    <!-- If Onboarding is NOT Completed -->
    @else {
      @if (error() && !success()) {
        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
          {{ error() }}
        </div>
      }

      @if (success()) {
        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4">
          Onboarding completed successfully!
        </div>
      }

      <form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-6 bg-white rounded-2xl shadow-lg p-8">
        <div class="mb-6">
          <p class="text-gray-600 text-lg">Let's get you started! Please fill in your fitness information below.</p>
        </div>

        <!-- Height -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Height (cm) <span class="text-red-500">*</span>
          </label>
          <input
            type="number"
            formControlName="heightCm"
            step="1"
            min="50"
            max="300"
            class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
            placeholder="Enter your height in cm"
          />
          @if (form.get('heightCm')?.invalid && form.get('heightCm')?.touched) {
            <p class="text-red-500 text-sm mt-2">Height must be between 50-300 cm</p>
          }
        </div>

        <!-- Starting Weight -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Starting Weight (kg) <span class="text-red-500">*</span>
          </label>
          <input
            type="number"
            formControlName="startingWeightKg"
            step="0.1"
            min="20"
            max="500"
            class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
            placeholder="Enter your starting weight in kg"
          />
          @if (form.get('startingWeightKg')?.invalid && form.get('startingWeightKg')?.touched) {
            <p class="text-red-500 text-sm mt-2">Weight must be between 20-500 kg</p>
          }
        </div>

        <!-- Fitness Goal -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Fitness Goal <span class="text-red-500">*</span>
          </label>
          <select
            formControlName="goal"
            class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
          >
            <option value="">Select your fitness goal</option>
            @for (option of goalOptions; track option.value) {
              <option [value]="option.value">{{ option.label }}</option>
            }
          </select>
          @if (form.get('goal')?.invalid && form.get('goal')?.touched) {
            <p class="text-red-500 text-sm mt-2">Please select a fitness goal</p>
          }
        </div>

        <!-- Experience Level -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Experience Level <span class="text-red-500">*</span>
          </label>
          <select
            formControlName="experienceLevel"
            class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
          >
            <option value="">Select your experience level</option>
            @for (option of experienceLevelOptions; track option.value) {
              <option [value]="option.value">{{ option.label }}</option>
            }
          </select>
          @if (form.get('experienceLevel')?.invalid && form.get('experienceLevel')?.touched) {
            <p class="text-red-500 text-sm mt-2">Please select your experience level</p>
          }
        </div>

        <!-- Submit Button -->
        <div class="pt-6">
          <button
            type="submit"
            [disabled]="loading() || form.invalid"
            class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-semibold py-3 rounded-lg transition shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
          >
            @if (loading()) {
              <span class="flex items-center justify-center gap-2">
                <svg class="w-5 h-5 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Completing Onboarding...
              </span>
            } @else {
              Complete Onboarding
            }
          </button>
        </div>
      </form>
    }
  }
</div>
